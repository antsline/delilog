# delilog 要件定義書

## 1. プロジェクト概要

### 1.1 プロダクト名

**delilog（デリログ）**

### 1.2 プロダクトビジョン

貨物軽自動車運送事業者（自営業）向けの点呼記録管理アプリ。令和7年4月からの新たな安全対策に対応し、法令遵守を最小限の手間で実現する。将来的には運行管理から経営支援まで、自営業の管理業務をワンストップで提供する総合プラットフォームを目指す。

### 1.3 ターゲットユーザー

- 貨物軽自動車運送事業を営む個人事業主
- 主に1人で事業を行っている自営業ドライバー
- スマートフォンの基本操作ができる層（高齢者向けの特別な配慮は初期段階では考慮しない）

### 1.4 解決する課題

- 紙ベースの点呼記録管理の煩雑さ
- 法定保存期間（1年）の記録管理の負担
- 日々の安全管理業務の効率化
- コンビニでの印刷作業の簡素化
- 経営データの一元管理の困難さ

## 2. 機能要件

### 2.1 Phase 1: MVP（0-3ヶ月）

#### 2.1.1 認証機能

- **ログイン方法**
  - Apple ID認証
  - Google認証
  - 電話番号認証（SMS）
- **初回登録時の情報**
  - 屋号（会社名）
  - 運転者名
  - 営業所名（任意）
  - 車両番号（ナンバープレート）

#### 2.1.2 点呼記録機能

**業務前点呼**

- 実施日時（自動取得、編集不可）
- 車両番号（プルダウン選択）
- 点呼方法・執行者（デフォルト：対面・本人）
- アルコール検知器使用（有/無）
- 酒気帯びの有無（デフォルト：無、数値入力 0.00）
- 健康状態（良好/注意/不良の3段階、デフォルト：良好）
- 日常点検実施（完了/未実施）
- 特記事項（フリーテキスト、音声入力対応）

**業務後点呼**

- 実施日時（自動取得、編集不可）
- 車両番号（プルダウン選択）
- 点呼方法・執行者（デフォルト：対面・本人）
- アルコール検知器使用（有/無）
- 酒気帯びの有無（デフォルト：無、数値入力 0.00）
- 運行状況（○/×）
- 特記事項（フリーテキスト、音声入力対応）

#### 2.1.3 記録一覧機能

- 月単位での記録表示（縦スクロール型）
- 日付ごとのカード表示
- 記録状態の視覚的表示
  - ✅ 完了（業務前後とも記録済み）
  - ⚠️ 一部未完了
  - 🚫 運行なし
- 土日祝日の色分け表示
- 月送り/戻りナビゲーション

#### 2.1.4 PDF出力機能

- 週単位（日曜〜土曜）での点呼記録簿生成
- 国土交通省フォーマット準拠
- プレビュー表示
- 出力オプション
  - PDFファイル保存
  - 共有機能
  - コンビニプリント誘導

#### 2.1.5 設定機能

- 基本情報の編集
- 車両情報の追加/編集/削除（3台まで）
- デフォルト車両の設定

### 2.2 Phase 2: 機能拡充（3-6ヶ月）

#### 2.2.1 運行記録機能

- 開始/終了地点の記録
- 走行距離の自動計算
- 主要経過地点の記録
- 業務記録の国交省フォーマット対応

#### 2.2.2 日常点検機能

- チェックリスト形式の点検項目
- 写真添付機能
- 点検履歴の管理
- 異常時のアラート機能

#### 2.2.3 便利機能

- 記録のリマインダー通知
- 週次レポート自動生成
- データエクスポート（CSV形式）
- オフライン時の一時保存機能

### 2.3 Phase 3: プロプラン導入（6-9ヶ月）

#### 2.3.1 経営管理機能（プロプラン限定）

- 売上管理
  - 日次売上入力
  - 取引先別集計
  - 月次推移グラフ
- 経費記録
  - 燃料費
  - 高速代
  - その他経費
- 収支レポート
  - 月次損益計算
  - 前年同月比較

#### 2.3.2 請求書機能（プロプラン限定）

- 請求書作成・発行
- インボイス対応
- 取引先マスタ管理
- 入金ステータス管理
- PDF出力・メール送信

#### 2.3.3 高度な分析機能（プロプラン限定）

- 燃費分析
- 稼働率分析
- 収益性分析（案件別・取引先別）
- AIによる改善提案

#### 2.3.4 PC用Webアプリ（プロプラン標準機能）

**アクセス方法**

- Webブラウザからアクセス
- モバイルアプリと同じアカウントでログイン
- データは自動同期

**Web限定機能**

- ダッシュボード表示
  - 月次サマリー
  - KPI表示
  - アラート一覧
- 詳細分析
  - カスタムレポート作成
  - データのピボット分析
  - グラフのカスタマイズ
- 一括操作
  - 複数日の一括入力
  - CSVインポート/エクスポート
  - 一括PDF生成
- キーボードショートカット対応
- 印刷用レイアウト最適化

#### 2.3.5 その他プロプラン特典

- 車両登録無制限
- 優先サポート
- API連携機能
- データ保存期間3年

### 2.4 Phase 4: エコシステム拡大（9-12ヶ月）

#### 2.4.1 確定申告パック（オプション）

- 青色申告対応
- 仕訳自動生成
- 税理士連携機能

#### 2.4.2 車両管理プラス（オプション）

- 車検・保険期限管理
- メンテナンス記録
- 部品交換履歴

#### 2.4.3 マッチングサービス（オプション）

- 荷主とのマッチング
- 案件情報の提供
- 評価・レビュー機能

## 3. 非機能要件

### 3.1 ユーザビリティ

- ワンタップで点呼記録が完了できるUI
- デフォルト値による入力の簡素化
- 直感的なナビゲーション
- レスポンシブデザイン
- PC/モバイル間のシームレスな体験

### 3.2 パフォーマンス

- アプリ起動時間：3秒以内
- 画面遷移：1秒以内
- PDF生成：5秒以内
- オフライン時の基本機能動作
- Web版の初回読み込み：5秒以内

### 3.3 セキュリティ

- エンドツーエンド暗号化
- 生体認証対応（オプション）
- データの定期バックアップ
- プライバシーポリシー準拠
- 二要素認証（Web版）

### 3.4 可用性

- 99.9%のアップタイム
- 定期メンテナンス時の事前通知
- オフライン時のローカル保存
- クロスプラットフォーム対応

### 3.5 保守性

- エラーログの自動収集
- アプリ内フィードバック機能
- OTAアップデート対応
- A/Bテスト機能

## 4. 技術仕様

### 4.1 開発環境

**モバイルアプリ**

- **フレームワーク**: Expo (React Native)
- **状態管理**: Zustand
- **UIライブラリ**: NativeWind (Tailwind CSS)
- **PDF生成**: react-native-pdf

**Webアプリ（プロプラン用）**

- **フレームワーク**: Next.js + TypeScript
- **UIライブラリ**: Tailwind CSS + shadcn/ui
- **状態管理**: Zustand（モバイルと共通）

**バックエンド（共通）**

- **BaaS**: Supabase
- **認証**: Supabase Auth
- **データベース**: PostgreSQL
- **ストレージ**: Supabase Storage

### 4.2 プラットフォーム

- iOS 13.0以上
- Android 8.0以上
- Web（Chrome, Safari, Firefox, Edge最新版）

### 4.3 データベース設計

```typescript
// ユーザー情報
interface User {
  id: string;
  companyName: string; // 屋号
  driverName: string;
  officeName?: string;
  subscriptionTier: 'basic' | 'pro';
  subscriptionStatus: 'active' | 'cancelled' | 'past_due';
  lastWebAccess?: Date; // Web版最終アクセス
  createdAt: Date;
  updatedAt: Date;
}

// 車両情報
interface Vehicle {
  id: string;
  userId: string;
  plateNumber: string;
  isDefault: boolean;
  createdAt: Date;
}

// 点呼記録
interface TenkoRecord {
  id: string;
  userId: string;
  date: Date;
  type: 'before' | 'after';
  vehicleId: string;
  checkMethod: string;
  executor: string;
  alcoholDetectorUsed: boolean;
  alcoholDetected: boolean;
  alcoholLevel: number;
  healthStatus?: 'good' | 'caution' | 'poor';
  dailyCheckCompleted?: boolean;
  operationStatus?: 'ok' | 'ng';
  notes?: string;
  createdAt: Date;
  updatedAt: Date;
  platform: 'mobile' | 'web'; // 記録したプラットフォーム
}

// 運行記録（Phase 2）
interface OperationRecord {
  id: string;
  userId: string;
  date: Date;
  vehicleId: string;
  startTime: Date;
  endTime: Date;
  startLocation: string;
  endLocation: string;
  distance: number;
  mainStops: string[];
  createdAt: Date;
}

// 売上記録（Phase 3）
interface SalesRecord {
  id: string;
  userId: string;
  date: Date;
  clientId: string;
  amount: number;
  description: string;
  status: 'unpaid' | 'paid';
  invoiceId?: string;
  createdAt: Date;
}

// 経費記録（Phase 3）
interface ExpenseRecord {
  id: string;
  userId: string;
  date: Date;
  category: 'fuel' | 'highway' | 'maintenance' | 'other';
  amount: number;
  description: string;
  receiptUrl?: string;
  createdAt: Date;
}
```

## 5. ビジネスモデル

### 5.1 料金プラン

#### ベーシックプラン（月額980円）

**Phase 1の機能:**

- 点呼記録（無制限）
- PDF出力（無制限）
- 車両3台まで登録
- 1年間のデータ保存
- モバイルアプリのみ

**Phase 2で追加される機能:**

- 運行記録
- 日常点検
- リマインダー機能
- CSVエクスポート

#### プロプラン（月額1,980円）- Phase 3から提供

**ベーシックプランの全機能に加えて:**

- **PC用Webアプリ（標準搭載）**
- 売上・経費管理
- 請求書作成・発行
- 高度な分析機能
- ダッシュボード機能
- 車両登録無制限
- 3年間のデータ保存
- 優先サポート
- API連携

#### オプション（Phase 4から提供）

- 確定申告パック: +500円/月
- 車両管理プラス: +300円/月
- マッチングサービス: 成果報酬型

### 5.2 決済方法

- **初期**: アプリ内課金のみ
- **将来**: Web決済も追加（割引価格での提供検討）

### 5.3 プロモーション戦略

- 14日間無料トライアル
- 令和7年3月までの早期登録で初年度20%割引
- 年払いで2ヶ月分無料
- 紹介プログラム（1人紹介で1ヶ月無料）

## 6. スケジュール

### 6.1 開発フェーズ

- **Phase 1 (MVP)**: 3ヶ月
  - 月1: 基本設計・UI/UX設計
  - 月2: コア機能開発
  - 月3: テスト・改善
- **Phase 2**: 3ヶ月
  - 運行記録・日常点検機能の実装
- **Phase 3**: 3ヶ月
  - プロプラン機能の実装
  - PC用Webアプリの開発
- **Phase 4**: 3ヶ月
  - オプション機能の実装

### 6.2 リリース計画

- ベータ版リリース：令和7年1月
- 正式版リリース：令和7年3月
- Phase 2リリース：令和7年6月
- Phase 3リリース（プロプラン開始）：令和7年9月
- PC用Webアプリリリース：令和7年10月
- Phase 4リリース：令和7年12月

## 7. 成功指標（KPI）

### 7.1 Phase 1目標（3ヶ月）

- ダウンロード数：3,000件
- 有料会員数：1,000人
- 継続率（1ヶ月）：85%
- 月間売上：98万円

### 7.2 Phase 2目標（6ヶ月）

- ダウンロード数：8,000件
- 有料会員数：2,000人
- 継続率（3ヶ月）：75%
- 月間売上：196万円

### 7.3 Phase 3目標（1年）

- ダウンロード数：20,000件
- 有料会員数：5,000人（ベーシック3,500人、プロ1,500人）
- プロプラン転換率：30%
- Web版アクティブ率：プロプランの80%
- 継続率（6ヶ月）：70%
- 月間売上：640万円

### 7.4 長期目標（2年）

- 有料会員数：10,000人
- プロプラン比率：40%
- 月間売上：1,480万円

## 8. リスクと対策

### 8.1 技術的リスク

- **リスク**: オフライン時のデータ同期の複雑性
- **対策**: ローカルストレージとの段階的同期実装

### 8.2 法規制リスク

- **リスク**: 法改正による仕様変更
- **対策**: 柔軟な設計と迅速なアップデート体制

### 8.3 競合リスク

- **リスク**: 大手企業の参入
- **対策**: UI/UXの優位性維持とユーザーコミュニティ構築

### 8.4 収益性リスク

- **リスク**: プラットフォーム手数料による利益圧迫
- **対策**: 段階的な価値向上による適正価格の実現

### 8.5 開発リスク

- **リスク**: Web版開発による工数増大
- **対策**: モバイルとのコード共有最大化、段階的リリース

## 9. 今後の検討事項

- 多言語対応（外国人ドライバー向け）
- 他の運送業種への展開
- 保険会社との連携
- 行政への電子申請機能
- Web決済導入によるコスト削減
- AIを活用した自動入力機能
- 音声入力の精度向上
